<!DOCTYPE HTML>
<html>
<head>
<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
<style>
</style>
<script src="jquery.js"></script>
<script>


var items = ['fa-bath', 'fa-paw']

function displayNew(w,h,l,t,v) {
  var cont = $('<div/>')
             .css('position','relative')
             .css('overflow','hidden')
             .css('width',w)
             .css('height',h)
             .css('position','absolute')
             .css('left',l)
             .css('top',t)
             .css('color','red')

  function newThing(c) {
    return $('<div/>')
           .addClass('thing')
           .css('position','absolute')
           .css('width',w)
           .css('height',h)
           .css('left', 0)
           .css('top', 0)
           .css('font-size', 0.4 * h + 'px')
           .css('line-height', h + 'px')
           .css('text-align','center')
           .append($('<i/>').addClass('fa ' + items[c]))
  }

  function change(up,n) {
    var thing = cont.find('.thing')
    var g = up ? -h : h
    thing.animate({top: g}, 500, 'swing', function() { thing.remove() })

    var inner = newThing(n).css('top',-g)
    cont.append(inner)
    inner.animate({top: 0}, 500, 'swing')


  }

  cont.append(newThing(v))
  return { dom: cont, change: change }
}



function swiper(disp, i) {
  function getY(ev) { return ev.originalEvent.touches[0].pageY }

  var val = 0
  var y = 0

  function change(d) {
    val += d;
    if (val < 0) val = items.length - 1
    else if (val >= items.length) val = 0
  }

  disp.dom
    .bind('touchstart',function(ev) { y = getY(ev) })
    .bind('touchmove',function(ev) {
       var y1 = getY(ev)
       var d = y1 - y
       if (d > 70) { y = y1; change(1); disp.change(false, val) }
       if (d < -70) { y = y1; change(-1); disp.change(true, val) }
    })
}

function app(w,h) {
  var rows = 2
  var cols = 5

  var dw = w/cols
  var dh = h/rows

  var b = $('body').empty()

  for (var row = 0; row < rows; ++row) {
    for (var col = 0; col < cols; ++col) {
      var d = displayNew(dw,dh,col * dw,row * dh,0)
      swiper(d, row * cols + col)
      b.append(d.dom)
    }
  }
}

$(document).ready(function(ev) {
  app(window.screen.width,window.screen.height)
})
</script>
</head>
<body></body>
</html>
